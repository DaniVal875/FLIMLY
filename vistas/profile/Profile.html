<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Filmly - Perfil</title>
  <link rel="stylesheet" href="Profile.css">
</head>
<body>
  <header class="top-bar">
    <button class="back-btn" onclick="window.history.back()" title="Volver">
      â¬…
    </button>
    <h1 class="page-title">Perfil</h1>
  </header>

  <section class="profile-info" >
    <div class="avatar">
      <img src="https://tse1.mm.bing.net/th/id/OIP.rAxz10iucNJJPeb6wRPZjAHaHa?cb=12&rs=1&pid=ImgDetMain&o=7&rm=3" alt="Foto de perfil">
    </div>
    
    <h2 class="username" id="profile-username">Cargando...</h2>
    <p class="bio" id="profile-bio"></p>

    <div class="stats">
      <div class="stat">
        <span class="number" id="profile-followers">0</span>
        <span class="label">Seguidores</span>
      </div>
      <div class="stat">
        <span class="number" id="profile-following">0</span>
        <span class="label">Siguiendo</span>
      </div>
      <div class="stat">
        <span class="number" id="profile-reviews">0</span>
        <span class="label">Publicaciones</span>
      </div>
    </div>
    <div class="actions">
      <button class="btn edit" onclick="location.href='../edit-profile/Edit-Profile.html'">âœï¸ Editar</button>
      <button class="btn share">ğŸ”— Compartir</button>
    </div>
  </section>

  <section class="reviews">
    <h3 class="section-title">Mis ReseÃ±as</h3>
    <div class="review-grid">
      </div>
  </section>

  <script>
    // Se ejecuta cuando el HTML estÃ¡ completamente cargado
    document.addEventListener('DOMContentLoaded', function() {
      // 1. Llama al controlador de datos que creamos
      fetch('../../controladores/get_profile_controller.php')
        .then(response => {
          if (!response.ok) {
            // Si el controlador PHP devolviÃ³ un error (como 401)
            // redirigimos al login
            window.location.href = '../login/Login.html';
          }
          return response.json(); // Convierte la respuesta JSON en un objeto JS
        })
        .then(data => {
          // 2. Actualiza el HTML con los datos recibidos
          if (data) {
            document.getElementById('profile-username').textContent = data.nombre_usuario || 'Sin nombre';
            document.getElementById('profile-bio').textContent = data.descripcion || 'Sin descripciÃ³n.';
            document.getElementById('profile-followers').textContent = data.seguidores || 0;
            document.getElementById('profile-following').textContent = data.seguidos || 0;
            // (Dejamos pendiente el conteo de reseÃ±as)
          }
        })
        .catch(error => {
          console.error('Error al cargar el perfil:', error);
          // Opcional: mostrar un mensaje de error al usuario
        });
    });
  </script>
</body>
</html>